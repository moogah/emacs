#+title: Python Mode Configuration
#+author: Jeff Farr
#+property: header-args:emacs-lisp :tangle python.el
#+auto_tangle: y

* Introduction
This file configures Python development environment in Emacs, setting up syntax checking, code formatting, import sorting, and syntax highlighting.

* Basic Configuration
Setup lexical binding for better closures and variable scoping.

#+begin_src emacs-lisp
;; -*- lexical-binding: t; -*-
#+end_src

* Syntax Checking
** Flycheck
Flycheck provides on-the-fly syntax checking for many programming languages including Python.

[[https://www.flycheck.org/en/latest/][Documentation]]

*Note*: LSP provides Python diagnostics via ruff language server. Flycheck is kept installed globally for other languages and can be used alongside LSP diagnostics.

#+begin_src emacs-lisp
(use-package flycheck
  :straight t
  :init (global-flycheck-mode))
#+end_src

* Syntax Highlighting
Enable Tree-sitter for improved syntax highlighting in Python mode.

#+begin_src emacs-lisp
(add-hook 'python-mode-hook 'tree-sitter-hl-mode)
#+end_src

* LSP Integration

Language Server Protocol support for Python is configured in [[file:lsp-mode.org][lsp-mode.org]]. The configuration uses two complementary language servers:

- *basedpyright* - Type checking, intelligent completion, and semantic understanding
- *ruff* - Fast linting, import sorting, and code formatting (replaces black + isort + pylint)

This dual-server setup provides comprehensive Python development support:
- Type-aware code completion
- Jump to definition (including standard library and installed packages)
- Find all references across the project
- Automatic import management
- Code formatting on save
- Real-time linting with hundreds of rules

See [[file:lsp-mode.org::*Python][Python LSP Configuration]] for installation and setup details.

** Replaced Tools

The LSP configuration with ruff replaces the following tools that were previously configured:
- *black* - Formatting now handled by ruff
- *isort* - Import sorting now handled by ruff
- *pylint* - Linting now handled by ruff (with compatible rules)

The ruff configuration is compatible with existing black and isort settings in pyproject.toml.

* TODO Improvements
- Consider adding support for Python virtual environments with pyvenv or similar packages (LSP servers auto-detect venvs currently)
- Add pytest integration for running tests directly from Emacs
- Consider adding DAP mode for Python debugging support
