{"id":"emacs-x0a","title":"Bounds filtering includes partial overlaps despite docstring claiming exclusion","description":"**Bug**: The `jf/gptel--filter-bounds-before-position` function includes regions that start before but end after the branch point, contradicting its own docstring.\n\n**Location**: `config/gptel/sessions/branching.el:69-87`\n\n**Discrepancy**:\n- **Docstring (line 72)**: \"Regions that start before but end after POSITION are EXCLUDED (partial overlap)\"\n- **Implementation (line 82)**: Only checks `(\u003c (car region) position)` - does NOT check end position\n\n**Example**:\n```\nBranch point: 5420\nRegion: (4000 6000) - starts at 4000, ends at 6000\n\nExpected (per docstring): EXCLUDE (partial overlap)\nActual behavior: INCLUDE (only start checked)\n```\n\n**Impact**: \n- Branch bounds may include conversation elements that extend past the branch point\n- Could lead to unexpected content in branched sessions\n- Violates principle of clean truncation at branch point\n\n**Suggested Fix**:\nAdd end-position check to match docstring:\n```elisp\n(lambda (region)\n  ;; Include only if region ENDS before branch point\n  (\u003c (cadr region) position))\n```\n\nOr update docstring if current behavior is intended.\n\n**Discovered During**: OpenSpec sessions-branching spec verification","status":"open","priority":2,"issue_type":"task","owner":"moogah@gmail.com","created_at":"2026-02-05T14:20:07.407941+01:00","created_by":"Jeff Farr","updated_at":"2026-02-05T14:20:07.407941+01:00","labels":["branching","bug","gptel","sessions"]}
